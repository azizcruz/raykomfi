{% extends "base.html" %}
{% load thumbnail %}
{% load humanize %}

{% block content %}

<div class="w3-row">
    <div class="w3-col s12 m4 l4">
        <h4>{{post.category}}</h4>
        <div class="related-posts w3-border w3-padding-16">
            <div class="w3-row">
                <div class="w3-mobile">
                    <a href="#"><span class="raykomfi-tag w3-round-small">علي احمد</span> &nbsp; <span
                            class="raykomfi-color">رايكم في هذا الشيء
                            الجميل</span></a>
                </div>
                <hr>
            </div>
        </div>
    </div>
    <div class="w3-col s12 m8 l8">
        <div class="w3-row">
            <div class="w3-mobile w3-container">
                <h2>
                    <i class="fa fa-user" aria-hidden="true"></i>
                    {{post.creator}}
                </h2>
            </div>
            <div class="w3-mobile w3-container">
                {% if post.content %}
                <p>{{post.content}}</p>
                {% endif %}
            </div>
            <div class="w3-mobile w3-container">
                {% if post.image %}
                {% thumbnail post.image "200x200" crop="center" as im %}
                <!-- Trigger the Modal -->
                <img id="myImg" src="{{ im.url }}" alt="{{post.title}}" width="{{ im.width }}" height="{{ im.height }}">

                <!-- The Modal -->
                <div id="myModal" class="modal">

                    <!-- Modal Content (The Image) -->
                    <img class="modal-content" id="modalImage">

                    <!-- Modal Caption (Image Text) -->
                    <div id="caption"></div>
                </div>
                {% endthumbnail %}
                {% endif %}
            </div>
            <div class="w3-container">
                <div><small><i class="fa fa-clock-o" aria-hidden="true"></i> {{post.created | naturaltime}}</small>
                </div>
                <div><small><i class="fa fa-tags" aria-hidden="true"></i> {{post.category}}</small></div>
            </div>
            <hr>
            <div class="w3-mobile w3-container reply-buttons">
                <h3>الاراء</h3>
                {% if post.comments.all|length > 0 %}
                {% for comment in post.comments.all %}
                <div class="w3-row comment-wrapper w3-border w3-padding w3-round-large">
                    <div class="w3-col s10 m11 l11">
                        <div class="comment-side">

                            <div class="name"><i class="fa fa-user" aria-hidden="true"></i>
                                {{comment.user.username}}</div>
                            <small><i class="fa fa-clock-o" aria-hidden="true"></i>
                                {{comment.created | naturaltime}}</small>
                            <div class="comment">{{ comment.content }}</div>
                        </div>
                        <hr>
                        <div class="comment-reply-side w3-padding w3-round-large">
                            {% for reply in comment.replies.all %}
                            <div class="w3-panel">
                                <div class="name"><i class="fa fa-user" aria-hidden="true"></i>
                                    {{reply.user.username}}
                                </div>
                                <small><i class="fa fa-clock-o" aria-hidden="true"></i>
                                    {{reply.created | naturaltime}}</small>
                                <div class="comment">{{ reply.content }}</div>
                            </div>
                            <hr>
                            {% endfor %}
                            {% if user.email_active %}
                            <form action="{% url 'raykomfi:post-reply' post_id=post.id comment_id=comment.id  %}"
                                method='post'>
                                {% csrf_token %}
                                {{ reply_form }}
                                <div class="col s12">
                                    <button type='submit' class='w3-button w3-round-large'> اضافة رد</button>
                                </div>
                            </form>
                            {% endif %}
                        </div>
                    </div>
                    <div class="w3-col s2 m1 l1 w3-center vote-side">
                        <div>
                            <form action="" method="post">
                                <input type="hidden" name="vote" id="" value="like">
                                <span onclick="alert(0)"><i class="fa fa-thumbs-up w3-large"
                                        aria-hidden="true"></i></span>
                            </form>
                        </div>
                        <div>{{comment.votes}}</div>
                        <div>
                            <form action="" method="post">
                                <input type="hidden" name="vote" id="" value="dislike">
                                <span onclick="alert(0)"><i class="fa fa-thumbs-down w3-large"
                                        aria-hidden="true"></i></span>
                            </form>
                        </div>
                    </div>
                </div>
                {% endfor %}
                {% else %}
                <p>لا يوجد رأي حتى الان, كن أول شخص يعطي رأيه</p>
                {% endif %}
            </div>
            <div class="w3-mobile w3-container comment-button">
                <h3>اضافة تعليق</h3>
                {% if user.email_active %}
                <form action="{% url 'raykomfi:post-comment' post_id=post.id %}" method='post'>
                    {% csrf_token %}
                    {{ comment_form }}
                    <div class="col s12">
                        <button type='submit' class='w3-button w3-round-large'> اضافة تعليق</button>
                    </div>
                </form>
                {% else %}
                <div class="w3-display-container w3-panel w3-border message-wrapper w3-pale-yellow">
                    <p class="w3-center">فعل حسابك للمشاركة في التعليقات</p>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

{% endblock content %}