/*!
 * jQuery Cookiebar Plugin
 * https://github.com/carlwoodhouse/jquery.cookieBar
 *
 * Copyright 2012-17, Carl Woodhouse. the cookie function is inspired by https://github.com/carhartl/jquery-cookie
 * Disclaimer: if you still get fined for not complying with the eu cookielaw, it's not our fault.
 * Licence: MIT
 */(function($){$.cookie=function(key,value,options){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(value))||value===null||value===undefined)){options=$.extend({},options);if(value===null||value===undefined){options.expires=-1;}
if(typeof options.expires==="number"){var days=options.expires,t=(options.expires=new Date());t.setDate(t.getDate()+days);}
value=String(value);return(document.cookie=[encodeURIComponent(key),"=",options.raw?value:encodeURIComponent(value),options.expires?"; expires="+options.expires.toUTCString():"",options.path?"; path="+options.path:"",options.domain?"; domain="+options.domain:"",options.secure?"; secure":"",].join(""));}
options=value||{};var decode=options.raw?function(s){return s;}:decodeURIComponent;var pairs=document.cookie.split("; ");for(var i=0,pair;(pair=pairs[i]&&pairs[i].split("="));i++){if(decode(pair[0])===key)return decode(pair[1]||"");}
return null;};$.fn.cookieBar=function(options){var settings=$.extend({closeButton:"none",hideOnClose:true,secure:false,path:"/",domain:"",name:"cookiebar",expiresDays:365,},options);return this.each(function(){var cookiebar=$(this);cookiebar.hide();if(settings.closeButton=="none"){cookiebar.append('<a class="cookiebar-close">Continue</a>');$.extend(settings,{closeButton:".cookiebar-close"});}
if($.cookie(settings.name)!="hide"){cookiebar.show();}
cookiebar.find(settings.closeButton).click(function(){if(settings.hideOnClose){cookiebar.hide();}
$.cookie(settings.name,"hide",{path:settings.path,secure:settings.secure,domain:settings.domain,expires:settings.expiresDays,});cookiebar.trigger("cookieBar-close");return false;});});};$.cookieBar=function(options){$("body").prepend('<div class="ui-widget"><div style="display: none;" class="cookie-message ui-widget-header blue"><p>By using this website you allow us to place cookies on your computer. They are harmless and never personally identify you.</p></div></div>');$(".cookie-message").cookieBar(options);};})(jQuery);;/*! jQuery Color v@2.1.2 http://github.com/jquery/jquery-color | jquery.org/license */(function(a,b){function m(a,b,c){var d=h[b.type]||{};return a==null?c||!b.def?null:b.def:((a=d.floor?~~a:parseFloat(a)),isNaN(a)?b.def:d.mod?(a+d.mod)%d.mod:0>a?0:d.max<a?d.max:a);}
function n(b){var c=f(),d=(c._rgba=[]);return((b=b.toLowerCase()),l(e,function(a,e){var f,h=e.re.exec(b),i=h&&e.parse(h),j=e.space||"rgba";if(i)
return((f=c[j](i)),(c[g[j].cache]=f[g[j].cache]),(d=c._rgba=f._rgba),!1);}),d.length?(d.join()==="0,0,0,0"&&a.extend(d,k.transparent),c):k[b]);}
function o(a,b,c){return((c=(c+1)%1),c*6<1?a+(b-a)*c*6:c*2<1?b:c*3<2?a+(b-a)*(2/3-c)*6:a);}
var c="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",d=/^([\-+])=\s*(\d+\.?\d*)/,e=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(a){return[a[1],a[2],a[3],a[4]];},},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(a){return[a[1]*2.55,a[2]*2.55,a[3]*2.55,a[4]];},},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)];},},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16),];},},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(a){return[a[1],a[2]/100,a[3]/100,a[4]];},},],f=(a.Color=function(b,c,d,e){return new a.Color.fn.parse(b,c,d,e);}),g={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"},},},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"},},},},h={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0},},i=(f.support={}),j=a("<p>")[0],k,l=a.each;(j.style.cssText="background-color:rgba(1,1,1,.5)"),(i.rgba=j.style.backgroundColor.indexOf("rgba")>-1),l(g,function(a,b){(b.cache="_"+a),(b.props.alpha={idx:3,type:"percent",def:1});}),(f.fn=a.extend(f.prototype,{parse:function(c,d,e,h){if(c===b)return(this._rgba=[null,null,null,null]),this;if(c.jquery||c.nodeType)(c=a(c).css(d)),(d=b);var i=this,j=a.type(c),o=(this._rgba=[]);d!==b&&((c=[c,d,e,h]),(j="array"));if(j==="string")return this.parse(n(c)||k._default);if(j==="array")
return(l(g.rgba.props,function(a,b){o[b.idx]=m(c[b.idx],b);}),this);if(j==="object")
return(c instanceof f?l(g,function(a,b){c[b.cache]&&(i[b.cache]=c[b.cache].slice());}):l(g,function(b,d){var e=d.cache;l(d.props,function(a,b){if(!i[e]&&d.to){if(a==="alpha"||c[a]==null)return;i[e]=d.to(i._rgba);}
i[e][b.idx]=m(c[a],b,!0);}),i[e]&&a.inArray(null,i[e].slice(0,3))<0&&((i[e][3]=1),d.from&&(i._rgba=d.from(i[e])));}),this);},is:function(a){var b=f(a),c=!0,d=this;return(l(g,function(a,e){var f,g=b[e.cache];return(g&&((f=d[e.cache]||(e.to&&e.to(d._rgba))||[]),l(e.props,function(a,b){if(g[b.idx]!=null)return(c=g[b.idx]===f[b.idx]),c;})),c);}),c);},_space:function(){var a=[],b=this;return(l(g,function(c,d){b[d.cache]&&a.push(c);}),a.pop());},transition:function(a,b){var c=f(a),d=c._space(),e=g[d],i=this.alpha()===0?f("transparent"):this,j=i[e.cache]||e.to(i._rgba),k=j.slice();return((c=c[e.cache]),l(e.props,function(a,d){var e=d.idx,f=j[e],g=c[e],i=h[d.type]||{};if(g===null)return;f===null?(k[e]=g):(i.mod&&(g-f>i.mod/2?(f+=i.mod):f-g>i.mod/2&&(f-=i.mod)),(k[e]=m((g-f)*b+f,d)));}),this[d](k));},blend:function(b){if(this._rgba[3]===1)return this;var c=this._rgba.slice(),d=c.pop(),e=f(b)._rgba;return f(a.map(c,function(a,b){return(1-d)*e[b]+d*a;}));},toRgbaString:function(){var b="rgba(",c=a.map(this._rgba,function(a,b){return a==null?(b>2?1:0):a;});return c[3]===1&&(c.pop(),(b="rgb(")),b+c.join()+")";},toHslaString:function(){var b="hsla(",c=a.map(this.hsla(),function(a,b){return(a==null&&(a=b>2?1:0),b&&b<3&&(a=Math.round(a*100)+"%"),a);});return c[3]===1&&(c.pop(),(b="hsl(")),b+c.join()+")";},toHexString:function(b){var c=this._rgba.slice(),d=c.pop();return(b&&c.push(~~(d*255)),"#"+
a.map(c,function(a){return((a=(a||0).toString(16)),a.length===1?"0"+a:a);}).join(""));},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString();},})),(f.fn.parse.prototype=f.fn),(g.hsla.to=function(a){if(a[0]==null||a[1]==null||a[2]==null)
return[null,null,null,a[3]];var b=a[0]/255,c=a[1]/255,d=a[2]/255,e=a[3],f=Math.max(b,c,d),g=Math.min(b,c,d),h=f-g,i=f+g,j=i*0.5,k,l;return(g===f?(k=0):b===f?(k=(60*(c-d))/h+360):c===f?(k=(60*(d-b))/h+120):(k=(60*(b-c))/h+240),h===0?(l=0):j<=0.5?(l=h/i):(l=h/(2-i)),[Math.round(k)%360,l,j,e==null?1:e]);}),(g.hsla.from=function(a){if(a[0]==null||a[1]==null||a[2]==null)
return[null,null,null,a[3]];var b=a[0]/360,c=a[1],d=a[2],e=a[3],f=d<=0.5?d*(1+c):d+c-d*c,g=2*d-f;return[Math.round(o(g,f,b+1/3)*255),Math.round(o(g,f,b)*255),Math.round(o(g,f,b-1/3)*255),e,];}),l(g,function(c,e){var g=e.props,h=e.cache,i=e.to,j=e.from;(f.fn[c]=function(c){i&&!this[h]&&(this[h]=i(this._rgba));if(c===b)return this[h].slice();var d,e=a.type(c),k=e==="array"||e==="object"?c:arguments,n=this[h].slice();return(l(g,function(a,b){var c=k[e==="object"?a:b.idx];c==null&&(c=n[b.idx]),(n[b.idx]=m(c,b));}),j?((d=f(j(n))),(d[h]=n),d):f(n));}),l(g,function(b,e){if(f.fn[b])return;f.fn[b]=function(f){var g=a.type(f),h=b==="alpha"?(this._hsla?"hsla":"rgba"):c,i=this[h](),j=i[e.idx],k;return g==="undefined"?j:(g==="function"&&((f=f.call(this,j)),(g=a.type(f))),f==null&&e.empty?this:(g==="string"&&((k=d.exec(f)),k&&(f=j+parseFloat(k[2])*(k[1]==="+"?1:-1))),(i[e.idx]=f),this[h](i)));};});}),(f.hook=function(b){var c=b.split(" ");l(c,function(b,c){(a.cssHooks[c]={set:function(b,d){var e,g,h="";if(d!=="transparent"&&(a.type(d)!=="string"||(e=n(d)))){d=f(e||d);if(!i.rgba&&d._rgba[3]!==1){g=c==="backgroundColor"?b.parentNode:b;while((h===""||h==="transparent")&&g&&g.style)
try{(h=a.css(g,"backgroundColor")),(g=g.parentNode);}catch(j){}
d=d.blend(h&&h!=="transparent"?h:"_default");}
d=d.toRgbaString();}
try{b.style[c]=d;}catch(j){}},}),(a.fx.step[c]=function(b){b.colorInit||((b.start=f(b.elem,c)),(b.end=f(b.end)),(b.colorInit=!0)),a.cssHooks[c].set(b.elem,b.start.transition(b.end,b.pos));});});}),f.hook(c),(a.cssHooks.borderColor={expand:function(a){var b={};return(l(["Top","Right","Bottom","Left"],function(c,d){b["border"+d+"Color"]=a;}),b);},}),(k=a.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff",});})(jQuery);;var notify_badge_class;var notify_menu_class;var notify_api_url;var notify_fetch_count;var notify_unread_url;var notify_mark_all_unread_url;var notify_refresh_period=15000;var consecutive_misfires=0;var registered_functions=[];function fill_notification_badge(data){var badges=document.getElementsByClassName(notify_badge_class);if(badges){for(var i=0;i<badges.length;i++){badges[i].innerHTML=data.unread_count;}}}
function fill_notification_list(data){var menus=document.getElementsByClassName(notify_menu_class);if(menus){var messages=data.unread_list.map(function(item){var message="";if(typeof item.actor!=='undefined'){message=item.actor;}
if(typeof item.verb!=='undefined'){message=message+" "+item.verb;}
if(typeof item.target!=='undefined'){message=message+" "+item.target;}
if(typeof item.timestamp!=='undefined'){message=message+" "+item.timestamp;}
return'<li>'+message+'</li>';}).join('')
for(var i=0;i<menus.length;i++){menus[i].innerHTML=messages;}}}
function register_notifier(func){registered_functions.push(func);}
function fetch_api_data(){if(registered_functions.length>0){var r=new XMLHttpRequest();r.addEventListener('readystatechange',function(event){if(this.readyState===4){if(this.status===200){consecutive_misfires=0;var data=JSON.parse(r.responseText);registered_functions.forEach(function(func){func(data);});}else{consecutive_misfires++;}}})
r.open("GET",notify_api_url+'?max='+notify_fetch_count,true);r.send();}
if(consecutive_misfires<10){setTimeout(fetch_api_data,notify_refresh_period);}else{var badges=document.getElementsByClassName(notify_badge_class);if(badges){for(var i=0;i<badges.length;i++){badges[i].innerHTML="!";badges[i].title="Connection lost!"}}}}
setTimeout(fetch_api_data,1000);;/*! jQuery & Zepto Lazy v1.7.10 - http://jquery.eisbehr.de/lazy - MIT&GPL-2.0 license - Copyright 2012-2018 Daniel 'Eisbehr' Kern */!function(t,e){"use strict";function r(r,a,i,u,l){function f(){L=t.devicePixelRatio>1,i=c(i),a.delay>=0&&setTimeout(function(){s(!0)},a.delay),(a.delay<0||a.combined)&&(u.e=v(a.throttle,function(t){"resize"===t.type&&(w=B=-1),s(t.all)}),u.a=function(t){t=c(t),i.push.apply(i,t)},u.g=function(){return i=n(i).filter(function(){return!n(this).data(a.loadedName)})},u.f=function(t){for(var e=0;e<t.length;e++){var r=i.filter(function(){return this===t[e]});r.length&&s(!1,r)}},s(),n(a.appendScroll).on("scroll."+l+" resize."+l,u.e))}function c(t){var i=a.defaultImage,o=a.placeholder,u=a.imageBase,l=a.srcsetAttribute,f=a.loaderAttribute,c=a._f||{};t=n(t).filter(function(){var t=n(this),r=m(this);return!t.data(a.handledName)&&(t.attr(a.attribute)||t.attr(l)||t.attr(f)||c[r]!==e)}).data("plugin_"+a.name,r);for(var s=0,d=t.length;s<d;s++){var A=n(t[s]),g=m(t[s]),h=A.attr(a.imageBaseAttribute)||u;g===N&&h&&A.attr(l)&&A.attr(l,b(A.attr(l),h)),c[g]===e||A.attr(f)||A.attr(f,c[g]),g===N&&i&&!A.attr(E)?A.attr(E,i):g===N||!o||A.css(O)&&"none"!==A.css(O)||A.css(O,"url('"+o+"')")}return t}function s(t,e){if(!i.length)return void(a.autoDestroy&&r.destroy());for(var o=e||i,u=!1,l=a.imageBase||"",f=a.srcsetAttribute,c=a.handledName,s=0;s<o.length;s++)if(t||e||A(o[s])){var g=n(o[s]),h=m(o[s]),b=g.attr(a.attribute),v=g.attr(a.imageBaseAttribute)||l,p=g.attr(a.loaderAttribute);g.data(c)||a.visibleOnly&&!g.is(":visible")||!((b||g.attr(f))&&(h===N&&(v+b!==g.attr(E)||g.attr(f)!==g.attr(F))||h!==N&&v+b!==g.css(O))||p)||(u=!0,g.data(c,!0),d(g,h,v,p))}u&&(i=n(i).filter(function(){return!n(this).data(c)}))}function d(t,e,r,i){++z;var o=function(){y("onError",t),p(),o=n.noop};y("beforeLoad",t);var u=a.attribute,l=a.srcsetAttribute,f=a.sizesAttribute,c=a.retinaAttribute,s=a.removeAttribute,d=a.loadedName,A=t.attr(c);if(i){var g=function(){s&&t.removeAttr(a.loaderAttribute),t.data(d,!0),y(T,t),setTimeout(p,1),g=n.noop};t.off(I).one(I,o).one(D,g),y(i,t,function(e){e?(t.off(D),g()):(t.off(I),o())})||t.trigger(I)}else{var h=n(new Image);h.one(I,o).one(D,function(){t.hide(),e===N?t.attr(C,h.attr(C)).attr(F,h.attr(F)).attr(E,h.attr(E)):t.css(O,"url('"+h.attr(E)+"')"),t[a.effect](a.effectTime),s&&(t.removeAttr(u+" "+l+" "+c+" "+a.imageBaseAttribute),f!==C&&t.removeAttr(f)),t.data(d,!0),y(T,t),h.remove(),p()});var m=(L&&A?A:t.attr(u))||"";h.attr(C,t.attr(f)).attr(F,t.attr(l)).attr(E,m?r+m:null),h.complete&&h.trigger(D)}}function A(t){var e=t.getBoundingClientRect(),r=a.scrollDirection,n=a.threshold,i=h()+n>e.top&&-n<e.bottom,o=g()+n>e.left&&-n<e.right;return"vertical"===r?i:"horizontal"===r?o:i&&o}function g(){return w>=0?w:w=n(t).width()}function h(){return B>=0?B:B=n(t).height()}function m(t){return t.tagName.toLowerCase()}function b(t,e){if(e){var r=t.split(",");t="";for(var a=0,n=r.length;a<n;a++)t+=e+r[a].trim()+(a!==n-1?",":"")}return t}function v(t,e){var n,i=0;return function(o,u){function l(){i=+new Date,e.call(r,o)}var f=+new Date-i;n&&clearTimeout(n),f>t||!a.enableThrottle||u?l():n=setTimeout(l,t-f)}}function p(){--z,i.length||z||y("onFinishedAll")}function y(t,e,n){return!!(t=a[t])&&(t.apply(r,[].slice.call(arguments,1)),!0)}var z=0,w=-1,B=-1,L=!1,T="afterLoad",D="load",I="error",N="img",E="src",F="srcset",C="sizes",O="background-image";"event"===a.bind||o?f():n(t).on(D+"."+l,f)}function a(a,o){var u=this,l=n.extend({},u.config,o),f={},c=l.name+"-"+ ++i;return u.config=function(t,r){return r===e?l[t]:(l[t]=r,u)},u.addItems=function(t){return f.a&&f.a("string"===n.type(t)?n(t):t),u},u.getItems=function(){return f.g?f.g():{}},u.update=function(t){return f.e&&f.e({},!t),u},u.force=function(t){return f.f&&f.f("string"===n.type(t)?n(t):t),u},u.loadAll=function(){return f.e&&f.e({all:!0},!0),u},u.destroy=function(){return n(l.appendScroll).off("."+c,f.e),n(t).off("."+c),f={},e},r(u,l,a,f,c),l.chainable?a:u}var n=t.jQuery||t.Zepto,i=0,o=!1;n.fn.Lazy=n.fn.lazy=function(t){return new a(this,t)},n.Lazy=n.lazy=function(t,r,i){if(n.isFunction(r)&&(i=r,r=[]),n.isFunction(i)){t=n.isArray(t)?t:[t],r=n.isArray(r)?r:[r];for(var o=a.prototype.config,u=o._f||(o._f={}),l=0,f=t.length;l<f;l++)(o[t[l]]===e||n.isFunction(o[t[l]]))&&(o[t[l]]=i);for(var c=0,s=r.length;c<s;c++)u[r[c]]=t[0]}},a.prototype.config={name:"lazy",chainable:!0,autoDestroy:!0,bind:"load",threshold:500,visibleOnly:!1,appendScroll:t,scrollDirection:"both",imageBase:null,defaultImage:"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",placeholder:null,delay:-1,combined:!1,attribute:"data-src",srcsetAttribute:"data-srcset",sizesAttribute:"data-sizes",retinaAttribute:"data-retina",loaderAttribute:"data-loader",imageBaseAttribute:"data-imagebase",removeAttribute:!0,handledName:"handled",loadedName:"loaded",effect:"show",effectTime:0,enableThrottle:!0,throttle:250,beforeLoad:e,afterLoad:e,onError:e,onFinishedAll:e},n(t).on("load",function(){o=!0})}(window);;(function($){$("#lazyLoadLink").on("click",function(){var link=$(this);var page=link.data("page");var category=link.data("category")||false;var user_id=link.data("user")||false;$.ajax({type:"post",url:"/api/lazy-posts/",data:{page:page,category:category,user_id:user_id,csrfmiddlewaretoken:Cookies.get("csrftoken"),},success:function(data){if(data.has_next){link.data("page",page+1);}else{link.hide();}
$("#raykomfi-posts").append(data.posts_html);fixTime();},error:function(xhr,status,error){console.log(error);},});});$("#lazyLoadLinkComments").on("click",function(){var link=$(this);var page=link.data("page");var user_id=link.data("user")||false;var post_id=document.getElementById("post_id")?parseInt(document.getElementById("post_id").value):false;$.ajax({type:"post",url:"/api/lazy-comments/",data:{page:page,post_id:post_id,csrfmiddlewaretoken:Cookies.get("csrftoken"),user_id:user_id,},success:function(data){if(data.has_next){link.data("page",page+1);}else{link.hide();}
if(user_id!==false){$("#user-comments").append(data.comments_html);}else{$("#posts-wrapper").append(data.comments_html);}
fixTime();generateStars();},error:function(xhr,status,error){console.log(error);},});});})(jQuery);;function fixTime(){$(".created-time").each((i,elem)=>{let fixedTime=`منذ ${
      elem.innerHTML.replace(/مضت|منذ/g, "").split("،")[0]
    }`;let timeNum=fixedTime.split(" ")[2];if(timeNum<11){fixedTime=fixedTime.replace(/دقيقة/g,'دقائق')}
if(fixedTime.indexOf("أسبوعين")>0){fixedTime="منذ أسبوعين";}
if(fixedTime.indexOf("سنتين")>0){fixedTime="منذ سنتين";}
if(fixedTime.indexOf("يومين")>0){fixedTime="منذ يومين";}
if(fixedTime.indexOf("دقيقتين")>0){fixedTime="منذ دقيقتين";}
if(fixedTime.indexOf("ثانيتين")>0){fixedTime="منذ ثانيتين";}
if(fixedTime.indexOf("الآن")>0){fixedTime="الآن";}
elem.innerHTML=fixedTime;});};function generateStars(){let opinionPower=$(".opinion-power");let starsGenerated="";if(opinionPower.length>0){for(let i=0;i<opinionPower.length;i++){let opinionPowerValue=parseFloat(opinionPower[i].innerHTML.replace(",","."))||false;starsGenerated="";if(opinionPowerValue){for(let i=0;i<parseInt(opinionPowerValue);i++){starsGenerated+='<span><i class="fa fa-star"aria-hidden="true"></i></span>';}
if(opinionPowerValue%1>0.0){starsGenerated+='<span><i class="fa fa-star-half-o" aria-hidden="true"></i></span>';}}else{starsGenerated='<span><i class="fa fa-star-o" aria-hidden="true"></i></span>';}
opinionPower[i].innerHTML=starsGenerated;}}};let post_wrapper=$("#posts-wrapper");let message_view=$("#messages-view");let view_html="";let loading=$("#spinner");function custom_alert(message,icon){document.getElementById("alert-message").innerText=message;document.getElementById("alert-icon").innerHTML=icon;document.getElementById("alert-modal").style.display="block";}
$(document).on("submit","form.replyForm",function(e){e.preventDefault();let content=e.target[1].value;let{commentId}=e.target.dataset;console.log(content);if(content){axios({method:"POST",url:"/api/reply/add",headers:{"X-CSRFTOKEN":Cookies.get("csrftoken"),"Content-Type":"application/json",},data:{content:content,comment_id:parseInt(commentId),},}).then((response)=>{let comment_view=$(`#comment-id-${commentId}`);view_html=response.data.view;comment_view.html(view_html);fixTime();generateStars();e.target[0].value="";}).catch((err)=>{if(err.response.status===403&&err.response.data.detail==="ليس لديك صلاحية للقيام بهذا الإجراء."){custom_alert("محاولات متكررة, يرجى المحاولة لاحقا","<i class='fa fa-warning'></i>");}});}});$(document).on("submit","form.closest-edit-reply-form",function(e){e.preventDefault();let content=e.target[1].value;let{replyId,commentId}=e.target.dataset;if(content){axios({method:"PUT",url:"/api/reply/edit",headers:{"X-CSRFTOKEN":Cookies.get("csrftoken"),"Content-Type":"application/json",},data:{content:content,reply_id:replyId,comment_id:commentId},}).then((response)=>{let view_html=response.data.view;let comment_wrapper=document.getElementById(`comment-id-${commentId}`);comment_wrapper.innerHTML=view_html;e.target[1].value="";fixTime();generateStars();}).catch((err)=>{if(err.response.status===403&&err.response.data.detail==="ليس لديك صلاحية للقيام بهذا الإجراء."){custom_alert("محاولات متكررة, يرجى المحاولة لاحقا","<i class='fa fa-warning'></i>");}});}});$(document).on("submit","form.commentForm",function(e){e.preventDefault();let content=e.target[1].value;let{postId}=e.target.dataset;if(content){axios({method:"POST",url:"/api/comment/add",headers:{"X-CSRFTOKEN":Cookies.get("csrftoken"),"Content-Type":"application/json",},data:{content:content,post_id:postId},}).then((response)=>{let view_html=response.data.view;let post_wrapper=document.getElementById("posts-wrapper");post_wrapper.innerHTML=view_html;$("#lazyLoadLinkComments").hide();e.target[1].value="";fixTime();generateStars();}).catch((err)=>{if(err.response.status===403&&err.response.data.detail==="ليس لديك صلاحية للقيام بهذا الإجراء."){custom_alert("محاولات متكررة, يرجى المحاولة لاحقا","<i class='fa fa-warning'></i>");}});}});$(document).on("submit","form.closest-edit-comment-form",function(e){e.preventDefault();let content=e.target[1].value;let{commentId}=e.target.dataset;if(content){axios({method:"PUT",url:"/api/comment/edit",headers:{"X-CSRFTOKEN":Cookies.get("csrftoken"),"Content-Type":"application/json",},data:{content:content,comment_id:commentId},}).then((response)=>{let view_html=response.data.view;let comment_wrapper=document.getElementById(`comment-id-${commentId}`);comment_wrapper.innerHTML=view_html;e.target[1].value="";fixTime();generateStars();}).catch((err)=>{if(err.response.status===403&&err.response.data.detail==="ليس لديك صلاحية للقيام بهذا الإجراء."){custom_alert("محاولات متكررة, يرجى المحاولة لاحقا","<i class='fa fa-warning'></i>");}});}});$(document).on("submit","form.voteForm",function(e){e.preventDefault();let{commentId,userId,voteType}=e.target.dataset;if(voteType){axios({method:"POST",url:"/api/comment/vote",headers:{"X-CSRFTOKEN":Cookies.get("csrftoken"),"Content-Type":"application/json",},data:{comment_id:parseInt(commentId),user_id:parseInt(userId),action_type:voteType,},}).then((response)=>{let votes_view=$(`#comment-${commentId}-vote-side-wrapper`);view_html=response.data.view;votes_view.html(view_html);}).catch((err)=>{if(err.response.status===403&&err.response.data.detail==="ليس لديك صلاحية للقيام بهذا الإجراء."){custom_alert("محاولات متكررة, يرجى المحاولة لاحقا","<i class='fa fa-warning'></i>");}});}});$(document).on("submit","form.getMessageForm",function(e){e.preventDefault();let{messageId}=e.target.dataset;if(messageId){axios({method:"POST",url:"/api/messages/get",headers:{"X-CSRFTOKEN":Cookies.get("csrftoken"),"Content-Type":"application/json",},data:{message_id:parseInt(messageId),},}).then((response)=>{view_html=response.data.view;message_view.html(view_html);let converter=new showdown.Converter();let message=document.getElementById("message-content-field");message.innerHTML=converter.makeHtml(message.innerHTML);fixTime();}).catch((err)=>{if(err.response.status===403&&err.response.data.detail==="ليس لديك صلاحية للقيام بهذا الإجراء."){custom_alert("محاولات متكررة, يرجى المحاولة لاحقا","<i class='fa fa-warning'></i>");}});}});$(document).on("submit","form.postsSearchForm",function(e){e.preventDefault();let link=$(this);let q=link.serializeArray()[1].value;loading.css("display","block");if(q){axios({method:"POST",url:"/api/posts/search",headers:{"X-CSRFTOKEN":Cookies.get("csrftoken"),"Content-Type":"application/json",},data:{searchField:q,},}).then((response)=>{let view_html=response.data.view;let post_wrapper=document.getElementById("raykomfi-posts");$("#lazyLoadLink").css("display","none");loading.css("display","none");post_wrapper.innerHTML=view_html;fixTime();}).catch((err)=>{loading.css("display","none");if(err.response.status===403&&err.response.data.detail==="ليس لديك صلاحية للقيام بهذا الإجراء."){custom_alert("محاولات متكررة, يرجى المحاولة لاحقا","<i class='fa fa-warning'></i>");}});}else{loading.css("display","none");}});$(document).on("submit","form.commentsSearchForm",function(e){e.preventDefault();let link=$(this);let q=link.serializeArray()[1].value;loading.css("display","block");if(q){axios({method:"POST",url:"/api/comments/search",headers:{"X-CSRFTOKEN":Cookies.get("csrftoken"),"Content-Type":"application/json",},data:{searchField:q,},}).then((response)=>{view_html=response.data.view;message_view.html(view_html);$(document).ready(()=>{console.log(response.data);let view_html=response.data.view;console.log(view_html);let post_wrapper=document.getElementById("user-comments");$("#lazyLoadLink").css("display","none");loading.css("display","none");post_wrapper.innerHTML=view_html;fixTime();generateStars();});}).catch((err)=>{if(err.response.status===403&&err.response.data.detail==="ليس لديك صلاحية للقيام بهذا الإجراء."){custom_alert("محاولات متكررة, يرجى المحاولة لاحقا","<i class='fa fa-warning'></i>");}});}else{loading.css("display","none");}});$(document).on("submit","form.reportForm",function(e){e.preventDefault();let content=e.target[1].value;let data=$(this).serializeArray();data={content:data[1].value,reported_url:data[2].value,topic:data[3].value,};console.log(data);if(content){axios({method:"POST",url:"/api/report/",headers:{"X-CSRFTOKEN":Cookies.get("csrftoken"),"Content-Type":"application/json",},data:data,}).then((response)=>{let sendBtn=$(".send-report-btn");sendBtn.attr("disabled",true);sendBtn.text(response.data.message);$("form.reportForm").trigger("reset");setTimeout(()=>{sendBtn.attr("disabled",false);sendBtn.text("إرسال");},60*1000);}).catch((err)=>{if(err.response.status===403&&err.response.data.detail==="ليس لديك صلاحية للقيام بهذا الإجراء."){custom_alert("محاولات متكررة, يرجى المحاولة لاحقا","<i class='fa fa-warning'></i>");}});}});;var formToValidate=$("#raykomfi-register-form, #profile-form, #signin-form, #forgot-password-form, #create-post-form, #change-password-form, #change-email-form, #new-message-form");if(formToValidate.length>0){formToValidate.parsley().on("field:validated",function(e){});};axios.defaults.baseURL="http://localhost:8000";function w3_open(){document.getElementById("mySidebar").style.display="block";document.getElementById("myOverlay").style.display="block";}
function w3_close(){document.getElementById("mySidebar").style.display="none";document.getElementById("myOverlay").style.display="none";}
window.onscroll=function(){if(myFunction){myFunction();}};window.CSRF_TOKEN=document.getElementById("csrf_token").innerHTML;let myTop=document.getElementById("myTop");let myIntro=document.getElementById("myIntro");if(myTop&&myIntro){function myFunction(){if(document.body.scrollTop>80||document.documentElement.scrollTop>80){myTop.classList.add("w3-card-4","w3-animate-opacity");myIntro.classList.add("w3-show-inline-block");}else{myIntro.classList.remove("w3-show-inline-block");myTop.classList.remove("w3-card-4","w3-animate-opacity");}}}
function myAccordion(id){var x=document.getElementById(id);if(x.className.indexOf("w3-show")==-1){x.className+=" w3-show";x.previousElementSibling.className+=" raykomfi-theme";}else{x.className=x.className.replace("w3-show","");x.previousElementSibling.className=x.previousElementSibling.className.replace(" raykomfi-theme","");}}
var modal=document.getElementById("raykomfi-myModal");var img=document.getElementById("raykomfi-myImg")||false;var modalImg=document.getElementById("raykomfi-modalImage");var captionText=document.getElementById("raykomfi-caption");if(img){img.onclick=function(){modal.style.display="block";modalImg.src=this.src;captionText.innerHTML=this.alt;};}
var span=document.getElementsByClassName("raykomfi-close")[0];if(img){$(document).on("click",function(event){if(!$(event.target).closest("#raykomfi-myImg").length){modal.style.display="none";}});}
$("#raykomfi-modalImage").on("click",function(event){event.stopPropagation();});$("html").addClass("hide-overflow");$(window).on("load",function(){$("html").removeClass("hide-overflow");$("#overlay").fadeOut(500);});var $loading=$("#sk-chase").hide();$(document).ajaxStart(function(){$loading.show();}).ajaxStop(function(){$loading.hide();});var $searchLoading=$("#spinner").hide();$(document).ajaxStart(function(){$searchLoading.show();}).ajaxStop(function(){$searchLoading.hide();});$("#new-message-content").on("keyup",(e)=>{let content=e.target.value;let converter=new showdown.Converter();content=converter.makeHtml(content);$("#message-preview").html(content);});$(".lazy-img").Lazy({scrollDirection:"vertical",effect:"fadeIn",visibleOnly:true,effectTime:1000,});if(!sessionStorage.getItem("country")){let options={method:"GET",hostname:"freegeoip.app",port:null,path:"/json/",headers:{accept:"application/json","content-type":"application/json",},};axios.get("https://freegeoip.app/json/").then((data)=>{sessionStorage.setItem("country",data.data.country_name);}).catch((err)=>{console.log(err);});}
let countryInput=$("#id_country");if(countryInput){countryInput.val(sessionStorage.getItem("country"));}
function fill_notification_badge_override(data){var badges=document.getElementsByClassName("live_notify_badge_override");if(badges){window.unreadCount=data.unread_count;if(data.unread_count>0){badges[0].innerHTML='<i class="fa fa-circle" aria-hidden="true"></i>';}else{badges[0].innerHTML="";}}}
function fill_notification_list_override(data){var menus=document.getElementsByClassName(notify_menu_class);if(menus){if(data.unread_list.length>0){var messages=data.unread_list.map(function(item){if(item.verb==="comment"){var message=`<a href='${
              item.description
            }'>لديك تعليق جديد على إستفسارك ${item.target} من ${
              item.actor
            }<div>${moment(item.timestamp).fromNow()}</div></a>`;return"<li class='w3-display-container'>"+message+"</li>";}
if(item.verb==="reply"){var message=`<a href='${
              item.description
            }'>لديك رد جديد على تعليقك من ${item.actor}<div>${moment(
              item.timestamp
            )
              .locale("ar-dz")
              .fromNow()}</div></a>`;return"<li class='w3-display-container'>"+message+"</li>";}
if(item.verb==="message"){var message=`<a href='${item.description}'>لديك رسالة جديدة من ${
              item.actor
            }<div>${moment(item.timestamp)
              .locale("ar-dz")
              .fromNow()}</div></a>`;return"<li class='w3-display-container'>"+message+"</li>";}
if(item.verb==="report"){var message=`<a href='${
              item.description
            }'>لديك بلاغ جديد<div>${moment(item.timestamp)
              .locale("ar-dz")
              .fromNow()}</div></a>`;return"<li class='w3-display-container'>"+message+"</li>";}
if(item.verb==="post_accepted"){var message=`<a href='${item.description}'>تم قبول إستفسارك ${
              item.target
            }<div>${moment(item.timestamp)
              .locale("ar-dz")
              .fromNow()}</div></a>`;return"<li class='w3-display-container'>"+message+"</li>";}}).join("");for(var i=0;i<menus.length;i++){menus[i].innerHTML=messages;}}else{menus[0].innerHTML="<div class=''>لا يوجد لديك إشعارات حاليا</div>";}}}
let noti_btn=$(".noti-modal");let close_noti=$(".close-noti");noti_btn.on("click",()=>{$(".noti-modal__overlay").show();});close_noti.on("click",()=>{setTimeout(()=>{$(".noti-modal__overlay").css("display","none");},200);});function show_hide_notifications(){document.getElementById("noti-dropdown").classList.toggle("noti-show");}
$("#noti-btn").on("click",()=>{show_hide_notifications();});window.onclick=function(event){if(!event.target.matches(".noti-dropbtn")){var dropdowns=document.getElementsByClassName("noti-dropdown-content");var i;for(i=0;i<dropdowns.length;i++){var openDropdown=dropdowns[i];if(openDropdown.classList.contains("noti-show")){openDropdown.classList.remove("noti-show");}}}
if(!event.target.matches("#share-btn")){var dropdowns=document.getElementsByClassName("raykomfi-share-dropdown");var i;for(i=0;i<dropdowns.length;i++){var openDropdown=dropdowns[i];if(openDropdown.classList.contains("w3-show")){openDropdown.classList.remove("w3-show");}}}};$("#search-btn").on("click",()=>{$("#search-field-wrapper").toggleClass("show-search-field");});fixTime();let postTitle=$("#create-post-form #id_title");if(postTitle.length>0){if(postTitle.val().length<1){postTitle.val("رايكم في ");postTitle.on("keydown",(e)=>{let currentVal=e.target.value;if(currentVal.length<=9){e.target.value="رايكم في ";}
let count=(currentVal.match(/رايكم في/g)||[]).length;if(count>1){postTitle.val("رايكم في");}});}}
generateStars();if(window.location.hash){let anchor=$(window.location.hash);$("html,body").animate({scrollTop:anchor.offset().top-50},"slow");setTimeout(()=>{anchor.stop().animate({backgroundColor:"#FFFFE0"},250).animate({backgroundColor:"#FFFFFF"},250).animate({backgroundColor:"#FFFFE0"},250).animate({backgroundColor:"#FFFFFF"},250).animate({backgroundColor:"#FFFFE0"},250).animate({backgroundColor:"#FFFFFF"},250);},700);}
document.addEventListener("DOMContentLoaded",function(){var elems=document.querySelectorAll(".tooltipped");var options={};var instances=M.Tooltip.init(elems,options);});document.addEventListener("DOMContentLoaded",function(){var elems=document.querySelectorAll(".modal");var options={};var instances=M.Modal.init(elems,options);});function shareDropdown(){var x=document.getElementById("share-dropdown");if(x.className.indexOf("w3-show")==-1){x.className+=" w3-show";}else{x.className=x.className.replace(" w3-show","");}}
$("#share-btn").on("click",()=>{shareDropdown();});$("#copy-post-url").on("click",(e)=>{e.preventDefault();var copyText=document.getElementById("inputToCopy");copyText.select();copyText.setSelectionRange(0,99999);document.execCommand("copy");});$(".cookie-message").cookieBar({closeButton:".cookie-close-button",expiresDays:30,});$("#i-dont-want-cookies").on("click",()=>{Cookies.set("cookiebar","hide");Cookies.set("useCookies",false,{expires:30});});$(document).on("click",".edit-comment-btn",(e)=>{let commentContent=e.target.dataset.content;let commentId=e.target.dataset.commentId;let closestEditCommentForm=$(".edit-comment-btn").parent().find(".editCommentForm-"+commentId);closestEditCommentForm[0][1].value=commentContent;closestEditCommentForm.css("display","block");closestEditCommentForm.parent().find(".comment").hide();closestEditCommentForm.parent().find(".comment-action-btn").hide();});$(document).on("click",".close-comment-edit-form",(e)=>{e.preventDefault();let commentId=e.target.dataset.commentId;let closestEditCommentForm=$(".close-comment-edit-form").parent().parent().find(".editCommentForm-"+commentId);closestEditCommentForm[0][1].value="";closestEditCommentForm.css("display","none");closestEditCommentForm.parent().find(".comment").show();closestEditCommentForm.parent().find(".comment-action-btn").show();});$(document).on("click",".edit-reply-btn",(e)=>{let replyContent=e.target.dataset.content;let replyId=e.target.dataset.replyId;let closestEditReplyForm=$(".edit-reply-btn").parent().find(".editReplyForm-"+replyId);closestEditReplyForm[0][1].value=replyContent;closestEditReplyForm.css("display","block");closestEditReplyForm.parent().find(".reply").hide();closestEditReplyForm.parent().find(".reply-action-btn").hide();});$(document).on("click",".close-reply-edit-form",(e)=>{e.preventDefault();let replyId=e.target.dataset.replyId;let closestEditReplyForm=$(".close-reply-edit-form").parent().parent().find(".editReplyForm-"+replyId);closestEditReplyForm[0][1].value="";closestEditReplyForm.css("display","none");closestEditReplyForm.parent().find(".reply").show();closestEditReplyForm.parent().find(".reply-action-btn").show();});;